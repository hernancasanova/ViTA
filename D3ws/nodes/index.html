<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>D3 nodes</title>
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css"/>
	<link rel="stylesheet" type="text/css" href="css/styles.css">
	</head>
<body>
	
	<div id="bar-chart"></div>

	<script src="//code.jquery.com/jquery-1.9.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.1/d3.min.js"></script>
	<script type="text/javascript">
		$(document).ready(function(){
			//  the data that powers the bar chart, a simple array of numeric values
			var chartdata = [40, 60, 80, 100, 70, 120, 100, 60, 70, 150, 120, 140];
			 
			//  the size of the overall svg element
			var height = 200,
			    width = 720,
			 
			//  the width of each bar and the offset between each bar
			    barWidth = 40,
			    barOffset = 20;

			var yScale = d3.scale.linear()
		        .domain([0, d3.max(chartdata)])
		        .range([0, height]);
		 
			var xScale = d3.scale.ordinal()
				.domain(d3.range(0, chartdata.length))
				.rangeBands([0, width]);

			var colors = d3.scale.linear()
							.domain([0, chartdata.length*.33, chartdata.length*.66, chartdata.length])
							.range(['#d6e9c6', '#bce8f1', '#faebcc', '#ebccd1']);
			 
			 
			rects = d3.select('#bar-chart').append('svg')
				  .attr('width', width)
				  .attr('height', height)
				  .style('background', '#bce8f1')
				  .selectAll('rect').data(chartdata)
				  .enter().append('rect')
				.style({'fill': function(data,i){return colors(i);}, 'stroke': '#31708f', 'stroke-width': '5'})
				    .attr('width', xScale.rangeBand())
				    .attr('height', function (data) {
				        return yScale(data);
				    })
				    .attr('x', function (data, i) {
				        return xScale(i);
				    })
				    .attr('y', function (data) {
				        return height - yScale(data);
				    })
				    .on('mouseover', function(data) {
				        dynamicColor = this.style.fill;
				        d3.select(this)
				            .style('fill', '#3c763d')
				    })
				 
				    .on('mouseout', function(data) {
				        d3.select(this)
				            .style('fill', dynamicColor)
				    })
				    .on('mousedown',function(data, i){
				    	$('.wrap').remove();
				    	$this = this;
				    	x = d3.select($this).attr("x"),
				    	h = d3.select($this).attr("height");
				    	$('<input/>',{type:'range',max:d3.max(chartdata),min:'0', value:chartdata[i]})
				    		.on('input',function(){
				    			chartdata[i] = this.value,
				    			d3.selectAll('rect').data(chartdata),
				  				d3.select($this).attr("height", yScale(this.value)) 
				    							.attr("y", height - yScale(this.value))})
				    		.change(function(){$(this.parentNode).remove();})
				    		.appendTo($("<div/>")
				    			.addClass('wrap')
				    			.css({
				    					position:'absolute',
				    					top:  ((height-data)+([-60,-20][Math.round(h/height)])) + 'px',
				    					left: x + 'px',
				    					'background-color':'white'
				    			}).appendTo('#bar-chart'));
				    });
		});
	</script>
</body>
</html>